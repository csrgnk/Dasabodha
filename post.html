<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Content</title>

<style>
body{margin:0;font-family:Arial;background:#f9f9f9}
.container{padding:30px 15px;max-width:800px;margin:auto}
.post-title{color:#002366}
</style>
</head>
<body>

<div id="header"></div>

<div class="container">
<h1 class="post-title" id="content-title"></h1>
<div id="content-body"></div>
</div>

<div id="footer"></div>

<script>
// Load header & footer
fetch('header.html')
.then(r=>r.text())
.then(d=>document.getElementById('header').innerHTML=d);

fetch('footer.html')
.then(r=>r.text())
.then(d=>document.getElementById('footer').innerHTML=d);

// Get slug
const params = new URLSearchParams(window.location.search);
const slug = params.get("slug");

if(!slug){
document.getElementById("content-title").innerText="Slug Missing";
throw new Error("Slug missing");
}

// Safe JSON loader
function loadJSON(path){
return fetch(path)
.then(res=>{
if(!res.ok) return [];
return res.json();
})
.catch(()=>[]);
}

Promise.all([
loadJSON('data/posts.json'),
loadJSON('data/pages.json')
])
.then(([posts,pages])=>{

// Ensure array format
if(!Array.isArray(posts)) posts = [posts];
if(!Array.isArray(pages)) pages = [pages];

// Find in posts
let item = posts.find(p=>p.slug===slug);

// If not found in posts, check pages
if(!item){
item = pages.find(p=>p.slug===slug);
}

if(!item){
document.getElementById("content-title").innerText="Content Not Found";
return;
}

// Set page
document.title = item.title || "Content";
document.getElementById("content-title").innerText = item.title || "";
document.getElementById("content-body").innerHTML = item.content || "";

})
.catch(err=>{
console.error(err);
document.getElementById("content-title").innerText="Error Loading Content";
});
</script>

</body>
</html>
